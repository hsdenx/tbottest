<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>tbottest.labgeneric &mdash; tbottest 0.0.1-265-g5b526b7 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html">
            
              <img src="../../_static/tbot-logo-white.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.0.1-265-g5b526b7
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">quick start</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart.html">Quick Start</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">generic approach</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../generic.html"><code class="docutils literal notranslate"><span class="pre">tbottest.generic</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../boardlocking.html"><code class="docutils literal notranslate"><span class="pre">tbottest.boardlocking</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tips.html">Tips</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Testcase Modules</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tc.html"><code class="docutils literal notranslate"><span class="pre">tbottest.tc</span></code> - Testcases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../iniconfig.html"><code class="docutils literal notranslate"><span class="pre">tbottest.initconfig</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../iniconfighelper.html"><code class="docutils literal notranslate"><span class="pre">tbottest.initconfighelper</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../machineinit.html"><code class="docutils literal notranslate"><span class="pre">tbottest.machineinit</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../connector.html"><code class="docutils literal notranslate"><span class="pre">tbottest.connector</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../decorators.html"><code class="docutils literal notranslate"><span class="pre">tbottest.decorators</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../powercontrol.html"><code class="docutils literal notranslate"><span class="pre">tbottest.powercontrol</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../labgeneric.html">Generic tbot config implementation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">generic config</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../boardspecific.html"><code class="docutils literal notranslate"><span class="pre">tbottest.tbotconfig</span></code> - ini file config</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">tbottest</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">tbottest.labgeneric</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for tbottest.labgeneric</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">typing</span>
<span class="kn">import</span> <span class="nn">tbot</span>
<span class="kn">from</span> <span class="nn">tbot.machine</span> <span class="kn">import</span> <span class="n">connector</span><span class="p">,</span> <span class="n">linux</span><span class="p">,</span> <span class="n">board</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">tbottest.initconfig</span> <span class="k">as</span> <span class="nn">ini</span>
<span class="kn">from</span> <span class="nn">tbot_contrib.gpio</span> <span class="kn">import</span> <span class="n">Gpio</span>
<span class="kn">from</span> <span class="nn">tbottest.connector</span> <span class="kn">import</span> <span class="n">KermitConnector</span>
<span class="kn">from</span> <span class="nn">tbottest.connector</span> <span class="kn">import</span> <span class="n">PicocomConnector</span>
<span class="kn">from</span> <span class="nn">tbottest.connector</span> <span class="kn">import</span> <span class="n">ScriptConnector</span>
<span class="kn">from</span> <span class="nn">tbottest</span> <span class="kn">import</span> <span class="n">builders</span>
<span class="kn">from</span> <span class="nn">tbottest</span> <span class="kn">import</span> <span class="n">powercontrol</span>
<span class="kn">from</span> <span class="nn">tbottest</span> <span class="kn">import</span> <span class="n">machineinit</span>
<span class="kn">from</span> <span class="nn">tbottest.common.boardlocking</span> <span class="kn">import</span> <span class="n">lab_get_lock</span>
<span class="kn">from</span> <span class="nn">tbottest.dynamicimport</span> <span class="kn">import</span> <span class="n">get_boardcallback_import</span>
<span class="kn">from</span> <span class="nn">tbottest.dynamicimport</span> <span class="kn">import</span> <span class="n">get_boardmodule_import</span>

<span class="kn">import</span> <span class="nn">tbottest.initconfighelper</span> <span class="k">as</span> <span class="nn">inithelper</span>

<span class="n">cfgt</span> <span class="o">=</span> <span class="n">ini</span><span class="o">.</span><span class="n">IniTBotConfig</span><span class="p">()</span>

<span class="n">_INIT_CACHE</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

<span class="n">LABSECTIONNAME</span> <span class="o">=</span> <span class="n">inithelper</span><span class="o">.</span><span class="n">get_lab_sectionname</span><span class="p">()</span>

<span class="k">if</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">shelltype</span> <span class="o">==</span> <span class="s2">&quot;bash&quot;</span><span class="p">:</span>
    <span class="n">LAB_LINUX_SHELL</span> <span class="o">=</span> <span class="n">linux</span><span class="o">.</span><span class="n">Bash</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">LAB_LINUX_SHELL</span> <span class="o">=</span> <span class="n">linux</span><span class="o">.</span><span class="n">Ash</span>


<div class="viewcode-block" id="boardPicocomConnector"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.boardPicocomConnector">[docs]</a><span class="k">class</span> <span class="nc">boardPicocomConnector</span><span class="p">(</span><span class="n">PicocomConnector</span><span class="p">):</span>
    <span class="n">bn</span> <span class="o">=</span> <span class="n">ini</span><span class="o">.</span><span class="n">generic_get_boardname</span><span class="p">()</span>
    <span class="n">cfg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;PICOCOM_</span><span class="si">{</span><span class="n">bn</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">sections</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">cfg</span> <span class="o">==</span> <span class="n">s</span><span class="p">:</span>
            <span class="n">baudrate</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s2">&quot;baudrate&quot;</span><span class="p">)</span>
            <span class="n">device</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s2">&quot;device&quot;</span><span class="p">)</span>
            <span class="n">delay</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s2">&quot;delay&quot;</span><span class="p">))</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">tmp</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s2">&quot;noreset&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="s2">&quot;True&quot;</span> <span class="ow">in</span> <span class="n">tmp</span><span class="p">:</span>
                    <span class="n">noreset</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">except</span><span class="p">:</span>  <span class="c1"># noqa: E722</span>
                <span class="k">pass</span></div>


<div class="viewcode-block" id="boardScriptConnector"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.boardScriptConnector">[docs]</a><span class="k">class</span> <span class="nc">boardScriptConnector</span><span class="p">(</span><span class="n">ScriptConnector</span><span class="p">):</span>
    <span class="n">bn</span> <span class="o">=</span> <span class="n">ini</span><span class="o">.</span><span class="n">generic_get_boardname</span><span class="p">()</span>
    <span class="n">cfg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SCRIPTCOM_</span><span class="si">{</span><span class="n">bn</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">sections</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">cfg</span> <span class="o">==</span> <span class="n">s</span><span class="p">:</span>
            <span class="n">scriptname</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s2">&quot;scriptname&quot;</span><span class="p">)</span>
            <span class="n">exitstring</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s2">&quot;exitstring&quot;</span><span class="p">)</span>
            <span class="n">boardname</span> <span class="o">=</span> <span class="n">bn</span></div>


<div class="viewcode-block" id="boardKermitConnector"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.boardKermitConnector">[docs]</a><span class="k">class</span> <span class="nc">boardKermitConnector</span><span class="p">(</span><span class="n">KermitConnector</span><span class="p">):</span>
    <span class="n">bn</span> <span class="o">=</span> <span class="n">ini</span><span class="o">.</span><span class="n">generic_get_boardname</span><span class="p">()</span>
    <span class="n">cfg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;KERMIT_</span><span class="si">{</span><span class="n">bn</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">sections</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">cfg</span> <span class="o">==</span> <span class="n">s</span><span class="p">:</span>
            <span class="n">kermit_cfg_file</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s2">&quot;cfgfile&quot;</span><span class="p">)</span>
            <span class="n">kermit_delay</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s2">&quot;delay&quot;</span><span class="p">))</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">ini</span><span class="o">.</span><span class="n">generic_get_boardname</span><span class="p">()</span></div>


<div class="viewcode-block" id="boardSSHConnector"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.boardSSHConnector">[docs]</a><span class="k">class</span> <span class="nc">boardSSHConnector</span><span class="p">(</span><span class="n">connector</span><span class="o">.</span><span class="n">SSHConnector</span><span class="p">):</span>

    <span class="n">cfgl</span> <span class="o">=</span> <span class="n">ini</span><span class="o">.</span><span class="n">IniConfig</span><span class="p">()</span>
    <span class="n">cfgp</span> <span class="o">=</span> <span class="n">cfgl</span><span class="o">.</span><span class="n">config_parser</span>
    <span class="n">tmpdir</span> <span class="o">=</span> <span class="n">cfgp</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;TC&quot;</span><span class="p">,</span> <span class="s2">&quot;tmpdir&quot;</span><span class="p">,</span> <span class="n">fallback</span><span class="o">=</span><span class="s2">&quot;/tmp&quot;</span><span class="p">)</span>

    <span class="n">ign_hostkey</span> <span class="o">=</span> <span class="n">cfgp</span><span class="o">.</span><span class="n">getboolean</span><span class="p">(</span><span class="s2">&quot;TC&quot;</span><span class="p">,</span> <span class="s2">&quot;ignore_hostkey&quot;</span><span class="p">,</span> <span class="n">fallback</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ign_hostkey</span><span class="p">:</span>
        <span class="n">ignore_hostkey</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">username</span> <span class="o">=</span> <span class="n">ini</span><span class="o">.</span><span class="n">init_get_config</span><span class="p">(</span><span class="n">cfgp</span><span class="p">,</span> <span class="s2">&quot;linux_user&quot;</span><span class="p">,</span> <span class="s2">&quot;root&quot;</span><span class="p">)</span>
    <span class="c1"># hostname for ssh machine to board</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">board_detect_lx_ethernet_interface</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span>
            <span class="n">get_boardmodule_import</span><span class="p">(),</span> <span class="s2">&quot;board_detect_lx_ethernet_interface&quot;</span>
        <span class="p">)</span>
        <span class="n">IP_BOARD_SSH_INTERFACE</span> <span class="o">=</span> <span class="n">board_detect_lx_ethernet_interface</span><span class="p">()</span>
        <span class="n">tbot</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">message</span><span class="p">(</span>
            <span class="n">tbot</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Use </span><span class="si">{</span><span class="n">IP_BOARD_SSH_INTERFACE</span><span class="si">}</span><span class="s2"> interface for ssh&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">yellow</span>
        <span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">IP_BOARD_SSH_INTERFACE</span> <span class="o">=</span> <span class="s2">&quot;eth0&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">ssh_ip_section</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;IPSETUP_</span><span class="si">{</span><span class="n">ini</span><span class="o">.</span><span class="n">generic_get_boardname</span><span class="p">()</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">IP_BOARD_SSH_INTERFACE</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">IP_BOARD</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ssh_ip_section</span><span class="p">,</span> <span class="s2">&quot;ipaddr&quot;</span><span class="p">)</span>
        <span class="n">hostname</span> <span class="o">=</span> <span class="n">IP_BOARD</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Please set ipaddr for ssh machine. Expect section </span><span class="si">{</span><span class="n">ssh_ip_section</span><span class="si">}</span><span class="s2"> with key ipaddr&quot;</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">authenticator</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">linux</span><span class="o">.</span><span class="n">auth</span><span class="o">.</span><span class="n">Authenticator</span><span class="p">:</span>
        <span class="n">cfgb</span> <span class="o">=</span> <span class="n">ini</span><span class="o">.</span><span class="n">IniConfig</span><span class="p">()</span>
        <span class="n">cfgp</span> <span class="o">=</span> <span class="n">cfgb</span><span class="o">.</span><span class="n">config_parser</span>
        <span class="n">ssh_keyfile</span> <span class="o">=</span> <span class="n">ini</span><span class="o">.</span><span class="n">init_get_config</span><span class="p">(</span><span class="n">cfgp</span><span class="p">,</span> <span class="s2">&quot;ssh_keyfile&quot;</span><span class="p">,</span> <span class="s2">&quot;None&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ssh_keyfile</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">linux</span><span class="o">.</span><span class="n">auth</span><span class="o">.</span><span class="n">PrivateKeyAuthenticator</span><span class="p">(</span><span class="n">ssh_keyfile</span><span class="p">)</span>

        <span class="n">ssh_password</span> <span class="o">=</span> <span class="n">ini</span><span class="o">.</span><span class="n">init_get_config</span><span class="p">(</span><span class="n">cfgp</span><span class="p">,</span> <span class="s2">&quot;ssh_password&quot;</span><span class="p">,</span> <span class="s2">&quot;None&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ssh_password</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">linux</span><span class="o">.</span><span class="n">auth</span><span class="o">.</span><span class="n">PasswordAuthenticator</span><span class="p">(</span><span class="n">ssh_password</span><span class="p">)</span>

        <span class="c1"># default, hopefully ssh config has all needed settings</span>
        <span class="k">return</span> <span class="n">linux</span><span class="o">.</span><span class="n">auth</span><span class="o">.</span><span class="n">NoneAuthenticator</span><span class="p">()</span></div>


<div class="viewcode-block" id="boardGpioControl"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.boardGpioControl">[docs]</a><span class="k">class</span> <span class="nc">boardGpioControl</span><span class="p">(</span><span class="n">powercontrol</span><span class="o">.</span><span class="n">GpiopmControl</span><span class="p">):</span>
<div class="viewcode-block" id="boardGpioControl.power_check"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.boardGpioControl.power_check">[docs]</a>    <span class="k">def</span> <span class="nf">power_check</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;poweroffonstart&quot;</span> <span class="ow">in</span> <span class="n">tbot</span><span class="o">.</span><span class="n">flags</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">poweroff</span><span class="p">()</span>

        <span class="k">return</span> <span class="kc">True</span></div>

    <span class="n">bn</span> <span class="o">=</span> <span class="n">ini</span><span class="o">.</span><span class="n">generic_get_boardname</span><span class="p">()</span>
    <span class="n">cfg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;GPIOPMCTRL_</span><span class="si">{</span><span class="n">bn</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">sections</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">cfg</span> <span class="o">==</span> <span class="n">s</span><span class="p">:</span>
            <span class="n">gpiopmctl_pin</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s2">&quot;gpiopmctl_pin&quot;</span><span class="p">)</span>
            <span class="n">gpiopmctl_state</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s2">&quot;gpiopmctl_state&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="boardPowerShellControl"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.boardPowerShellControl">[docs]</a><span class="k">class</span> <span class="nc">boardPowerShellControl</span><span class="p">(</span><span class="n">powercontrol</span><span class="o">.</span><span class="n">PowerShellScriptControl</span><span class="p">):</span>
<div class="viewcode-block" id="boardPowerShellControl.power_check"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.boardPowerShellControl.power_check">[docs]</a>    <span class="k">def</span> <span class="nf">power_check</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;poweroffonstart&quot;</span> <span class="ow">in</span> <span class="n">tbot</span><span class="o">.</span><span class="n">flags</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">poweroff</span><span class="p">()</span>

        <span class="k">return</span> <span class="kc">True</span></div>

    <span class="n">bn</span> <span class="o">=</span> <span class="n">ini</span><span class="o">.</span><span class="n">generic_get_boardname</span><span class="p">()</span>
    <span class="n">cfg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;POWERSHELLSCRIPT_</span><span class="si">{</span><span class="n">bn</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">sections</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">cfg</span> <span class="o">==</span> <span class="n">s</span><span class="p">:</span>
            <span class="n">shell_script</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s2">&quot;script&quot;</span><span class="p">))</span></div>


<div class="viewcode-block" id="boardSisControl"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.boardSisControl">[docs]</a><span class="k">class</span> <span class="nc">boardSisControl</span><span class="p">(</span><span class="n">powercontrol</span><span class="o">.</span><span class="n">SispmControl</span><span class="p">):</span>
<div class="viewcode-block" id="boardSisControl.power_check"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.boardSisControl.power_check">[docs]</a>    <span class="k">def</span> <span class="nf">power_check</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;poweroffonstart&quot;</span> <span class="ow">in</span> <span class="n">tbot</span><span class="o">.</span><span class="n">flags</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">poweroff</span><span class="p">()</span>

        <span class="k">return</span> <span class="kc">True</span></div>

    <span class="n">bn</span> <span class="o">=</span> <span class="n">ini</span><span class="o">.</span><span class="n">generic_get_boardname</span><span class="p">()</span>
    <span class="n">cfg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SISPMCTRL_</span><span class="si">{</span><span class="n">bn</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">sections</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">cfg</span> <span class="o">==</span> <span class="n">s</span><span class="p">:</span>
            <span class="n">sispmctl_device</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s2">&quot;device&quot;</span><span class="p">)</span>
            <span class="n">sispmctl_port</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s2">&quot;port&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="boardTMControl"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.boardTMControl">[docs]</a><span class="k">class</span> <span class="nc">boardTMControl</span><span class="p">(</span><span class="n">powercontrol</span><span class="o">.</span><span class="n">TM021Control</span><span class="p">):</span>
<div class="viewcode-block" id="boardTMControl.power_check"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.boardTMControl.power_check">[docs]</a>    <span class="k">def</span> <span class="nf">power_check</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;poweroffonstart&quot;</span> <span class="ow">in</span> <span class="n">tbot</span><span class="o">.</span><span class="n">flags</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">poweroff</span><span class="p">()</span>

        <span class="k">return</span> <span class="kc">True</span></div>

    <span class="n">bn</span> <span class="o">=</span> <span class="n">ini</span><span class="o">.</span><span class="n">generic_get_boardname</span><span class="p">()</span>
    <span class="n">cfg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;TM021_</span><span class="si">{</span><span class="n">bn</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">sections</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">cfg</span> <span class="o">==</span> <span class="n">s</span><span class="p">:</span>
            <span class="n">tm021_device</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s2">&quot;device&quot;</span><span class="p">)</span>
            <span class="n">tm021_baudrate</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s2">&quot;baudrate&quot;</span><span class="p">)</span>
            <span class="n">tm021_timeout</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s2">&quot;timeout&quot;</span><span class="p">)</span>
            <span class="n">tm021_address</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s2">&quot;address&quot;</span><span class="p">)</span>
            <span class="n">tm021_port</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s2">&quot;port&quot;</span><span class="p">)</span>
            <span class="n">tm021_debug</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s2">&quot;debug&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="boardTFControl"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.boardTFControl">[docs]</a><span class="k">class</span> <span class="nc">boardTFControl</span><span class="p">(</span><span class="n">powercontrol</span><span class="o">.</span><span class="n">TinkerforgeControl</span><span class="p">):</span>
    <span class="n">bn</span> <span class="o">=</span> <span class="n">ini</span><span class="o">.</span><span class="n">generic_get_boardname</span><span class="p">()</span>
    <span class="n">cfg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;TF_</span><span class="si">{</span><span class="n">bn</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">sections</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">cfg</span> <span class="o">==</span> <span class="n">s</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">uid</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s2">&quot;uid&quot;</span><span class="p">)</span>
            <span class="n">channel</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s2">&quot;channel&quot;</span><span class="p">)</span></div>


<span class="k">if</span> <span class="s2">&quot;tinkerforge&quot;</span> <span class="ow">in</span> <span class="n">tbot</span><span class="o">.</span><span class="n">flags</span><span class="p">:</span>
    <span class="n">BOARDCTL</span> <span class="o">=</span> <span class="n">boardTFControl</span>
<span class="k">elif</span> <span class="s2">&quot;gpiopower&quot;</span> <span class="ow">in</span> <span class="n">tbot</span><span class="o">.</span><span class="n">flags</span><span class="p">:</span>
    <span class="n">BOARDCTL</span> <span class="o">=</span> <span class="n">boardGpioControl</span>
<span class="k">elif</span> <span class="s2">&quot;powershellscript&quot;</span> <span class="ow">in</span> <span class="n">tbot</span><span class="o">.</span><span class="n">flags</span><span class="p">:</span>
    <span class="n">BOARDCTL</span> <span class="o">=</span> <span class="n">boardPowerShellControl</span>
<span class="k">else</span><span class="p">:</span>
    <span class="c1"># try to autodetect from tbot.ini file</span>
    <span class="k">if</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">sispmctrl</span><span class="p">:</span>
        <span class="n">BOARDCTL</span> <span class="o">=</span> <span class="n">boardSisControl</span>
    <span class="k">elif</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">powershellscript</span><span class="p">:</span>
        <span class="n">BOARDCTL</span> <span class="o">=</span> <span class="n">boardPowerShellControl</span>
    <span class="k">elif</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">gpiopowerctrl</span><span class="p">:</span>
        <span class="n">BOARDCTL</span> <span class="o">=</span> <span class="n">boardGpioControl</span>
    <span class="k">elif</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">tinkerforce</span><span class="p">:</span>
        <span class="n">BOARDCTL</span> <span class="o">=</span> <span class="n">boardTFControl</span>
    <span class="k">elif</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">tm021</span><span class="p">:</span>
        <span class="n">BOARDCTL</span> <span class="o">=</span> <span class="n">boardTMControl</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">bn</span> <span class="o">=</span> <span class="n">ini</span><span class="o">.</span><span class="n">generic_get_boardname</span><span class="p">()</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;please configure powerctrl for board </span><span class="si">{</span><span class="n">bn</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="c1"># if we want to download bootloader with uuu tool</span>
<span class="c1"># after powering on the board, we must load the bootloader</span>
<span class="c1"># with the uuu tool onto the board</span>
<div class="viewcode-block" id="boardControlUUU"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.boardControlUUU">[docs]</a><span class="k">class</span> <span class="nc">boardControlUUU</span><span class="p">(</span><span class="n">BOARDCTL</span><span class="p">,</span> <span class="n">machineinit</span><span class="o">.</span><span class="n">UUULoad</span><span class="p">):</span>
<div class="viewcode-block" id="boardControlUUU.get_uuu_tool"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.boardControlUUU.get_uuu_tool">[docs]</a>    <span class="k">def</span> <span class="nf">get_uuu_tool</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="o">.</span><span class="n">toolsdir</span><span class="p">()</span></div>

<div class="viewcode-block" id="boardControlUUU.uuu_loader_steps"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.boardControlUUU.uuu_loader_steps">[docs]</a>    <span class="k">def</span> <span class="nf">uuu_loader_steps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">lbd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="o">.</span><span class="n">tftp_dir</span><span class="p">()</span><span class="o">.</span><span class="n">_local_str</span><span class="p">()</span>
        <span class="n">ucfg</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">uuucfg</span><span class="p">[</span><span class="n">ini</span><span class="o">.</span><span class="n">generic_get_boardname</span><span class="p">()]</span>
        <span class="n">cmds</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">ucfg</span><span class="p">:</span>
            <span class="n">new</span> <span class="o">=</span> <span class="n">n</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;LBD&quot;</span><span class="p">,</span> <span class="n">lbd</span><span class="p">)</span>
            <span class="n">cmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">linux</span><span class="o">.</span><span class="n">Raw</span><span class="p">(</span><span class="n">new</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">cmds</span></div></div>


<div class="viewcode-block" id="boardControlXmodem"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.boardControlXmodem">[docs]</a><span class="k">class</span> <span class="nc">boardControlXmodem</span><span class="p">(</span><span class="n">BOARDCTL</span><span class="p">,</span> <span class="n">machineinit</span><span class="o">.</span><span class="n">XMODEMLoad</span><span class="p">):</span>
<div class="viewcode-block" id="boardControlXmodem.xmodem_loader_device"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.boardControlXmodem.xmodem_loader_device">[docs]</a>    <span class="k">def</span> <span class="nf">xmodem_loader_device</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">xmodemdevice</span><span class="p">[</span><span class="n">ini</span><span class="o">.</span><span class="n">generic_get_boardname</span><span class="p">()]</span></div>

<div class="viewcode-block" id="boardControlXmodem.xmodem_loader_steps"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.boardControlXmodem.xmodem_loader_steps">[docs]</a>    <span class="k">def</span> <span class="nf">xmodem_loader_steps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">lbd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="o">.</span><span class="n">tftp_dir</span><span class="p">()</span><span class="o">.</span><span class="n">_local_str</span><span class="p">()</span>
        <span class="n">xcfg</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">xmodemcfg</span><span class="p">[</span><span class="n">ini</span><span class="o">.</span><span class="n">generic_get_boardname</span><span class="p">()]</span>
        <span class="n">xdev</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmodem_loader_device</span><span class="p">()</span>
        <span class="n">cmds</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;TFTPDIR&quot;</span><span class="p">,</span> <span class="n">lbd</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">xcfg</span><span class="p">]</span>
        <span class="n">cmds</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;SERDEV&quot;</span><span class="p">,</span> <span class="n">xdev</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">cmds</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">cmds</span></div></div>


<div class="viewcode-block" id="boardControlDFUUTIL"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.boardControlDFUUTIL">[docs]</a><span class="k">class</span> <span class="nc">boardControlDFUUTIL</span><span class="p">(</span><span class="n">BOARDCTL</span><span class="p">,</span> <span class="n">machineinit</span><span class="o">.</span><span class="n">DFUUTIL</span><span class="p">):</span>
<div class="viewcode-block" id="boardControlDFUUTIL.dfuutil_loader_steps"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.boardControlDFUUTIL.dfuutil_loader_steps">[docs]</a>    <span class="k">def</span> <span class="nf">dfuutil_loader_steps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tftpd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="o">.</span><span class="n">tftp_dir</span><span class="p">()</span><span class="o">.</span><span class="n">_local_str</span><span class="p">()</span>
        <span class="n">cfg</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">dfuutilcfg</span><span class="p">[</span><span class="n">ini</span><span class="o">.</span><span class="n">generic_get_boardname</span><span class="p">()]</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cfg</span><span class="p">:</span>
            <span class="n">c</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;LBD&quot;</span><span class="p">,</span> <span class="n">tftpd</span><span class="p">)</span>
            <span class="n">c</span><span class="p">[</span><span class="s2">&quot;D&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="s2">&quot;D&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;LBD&quot;</span><span class="p">,</span> <span class="n">tftpd</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">cfg</span></div></div>


<span class="c1"># if we want to download bootloader with Lauterbach TRACE32</span>
<span class="c1"># after powering on the board, we must load the bootloader</span>
<span class="c1"># with the trace32 tool onto the board</span>
<div class="viewcode-block" id="boardControlLauterbach"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.boardControlLauterbach">[docs]</a><span class="k">class</span> <span class="nc">boardControlLauterbach</span><span class="p">(</span><span class="n">BOARDCTL</span><span class="p">,</span> <span class="n">machineinit</span><span class="o">.</span><span class="n">LauterbachLoad</span><span class="p">):</span>
<div class="viewcode-block" id="boardControlLauterbach.get_host"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.boardControlLauterbach.get_host">[docs]</a>    <span class="k">def</span> <span class="nf">get_host</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="s2">&quot;lauterbachusesshmachine&quot;</span> <span class="ow">in</span> <span class="n">tbot</span><span class="o">.</span><span class="n">flags</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">tbot</span><span class="o">.</span><span class="n">ctx</span><span class="p">()</span> <span class="k">as</span> <span class="n">cx</span><span class="p">:</span>
                <span class="n">lab</span> <span class="o">=</span> <span class="n">cx</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">tbot</span><span class="o">.</span><span class="n">role</span><span class="o">.</span><span class="n">LabHost</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">lab</span><span class="o">.</span><span class="n">has_sshmachine</span><span class="p">():</span>
                    <span class="k">with</span> <span class="n">lab</span><span class="o">.</span><span class="n">sshmachine</span><span class="p">()</span> <span class="k">as</span> <span class="n">lnxssh</span><span class="p">:</span>
                        <span class="c1"># lnxssh.exec0(&quot;uname&quot;, &quot;-a&quot;)</span>
                        <span class="c1"># ret, log = lnxssh.exec(&quot;ps&quot;, &quot;afx&quot;, linux.Raw(&quot;|&quot;), &quot;grep&quot;, &quot;dummy-1920x1080.conf&quot;, linux.Raw(&quot;|&quot;), &quot;grep&quot;, &quot;-v&quot;, &quot;grep&quot;)</span>
                        <span class="c1"># if ret != 0:</span>
                        <span class="c1">#    lnxssh.exec0(&quot;sudo&quot;, &quot;X&quot;, &quot;-config&quot;, &quot;/home/hs/data/Entwicklung/XXX/dummy-1920x1080.conf&quot;, &quot;:99&quot;, linux.Raw(&quot;&amp;&quot;))</span>
                        <span class="c1"># lnxssh.exec0(&quot;export&quot;, &quot;DISPLAY=:99&quot;)</span>

                        <span class="k">return</span> <span class="n">lnxssh</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">host</span></div>

    <span class="k">def</span> <span class="nf">get_trace32_verbose</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">cfg</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">lauterbachcfg</span><span class="p">[</span><span class="n">ini</span><span class="o">.</span><span class="n">generic_get_boardname</span><span class="p">()]</span>
        <span class="k">return</span> <span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;verbose&quot;</span><span class="p">]</span>

<div class="viewcode-block" id="boardControlLauterbach.get_trace32_install_path"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.boardControlLauterbach.get_trace32_install_path">[docs]</a>    <span class="k">def</span> <span class="nf">get_trace32_install_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">cfg</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">lauterbachcfg</span><span class="p">[</span><span class="n">ini</span><span class="o">.</span><span class="n">generic_get_boardname</span><span class="p">()]</span>
        <span class="k">return</span> <span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;install_path&quot;</span><span class="p">]</span></div>

<div class="viewcode-block" id="boardControlLauterbach.get_trace32_cmd"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.boardControlLauterbach.get_trace32_cmd">[docs]</a>    <span class="k">def</span> <span class="nf">get_trace32_cmd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">cfg</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">lauterbachcfg</span><span class="p">[</span><span class="n">ini</span><span class="o">.</span><span class="n">generic_get_boardname</span><span class="p">()]</span>
        <span class="k">return</span> <span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;cmd&quot;</span><span class="p">]</span></div>

<div class="viewcode-block" id="boardControlLauterbach.get_trace32_config"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.boardControlLauterbach.get_trace32_config">[docs]</a>    <span class="k">def</span> <span class="nf">get_trace32_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">cfg</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">lauterbachcfg</span><span class="p">[</span><span class="n">ini</span><span class="o">.</span><span class="n">generic_get_boardname</span><span class="p">()]</span>
        <span class="k">return</span> <span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;config&quot;</span><span class="p">]</span></div>

<div class="viewcode-block" id="boardControlLauterbach.get_trace32_script"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.boardControlLauterbach.get_trace32_script">[docs]</a>    <span class="k">def</span> <span class="nf">get_trace32_script</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">cfg</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">lauterbachcfg</span><span class="p">[</span><span class="n">ini</span><span class="o">.</span><span class="n">generic_get_boardname</span><span class="p">()]</span>
        <span class="k">return</span> <span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;script&quot;</span><span class="p">]</span></div></div>


<span class="c1"># if we want to download bootloader with Segger JLink</span>
<span class="c1"># after powering on the board, we must load the bootloader</span>
<span class="c1"># with the JLinkExe tool onto the board</span>
<div class="viewcode-block" id="boardControlSegger"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.boardControlSegger">[docs]</a><span class="k">class</span> <span class="nc">boardControlSegger</span><span class="p">(</span><span class="n">BOARDCTL</span><span class="p">,</span> <span class="n">machineinit</span><span class="o">.</span><span class="n">SeggerLoad</span><span class="p">):</span>
<div class="viewcode-block" id="boardControlSegger.get_host"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.boardControlSegger.get_host">[docs]</a>    <span class="k">def</span> <span class="nf">get_host</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">host</span></div>

<div class="viewcode-block" id="boardControlSegger.get_segger_cmds"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.boardControlSegger.get_segger_cmds">[docs]</a>    <span class="k">def</span> <span class="nf">get_segger_cmds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">cfg</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">seggercfg</span><span class="p">[</span><span class="n">ini</span><span class="o">.</span><span class="n">generic_get_boardname</span><span class="p">()]</span>
        <span class="k">return</span> <span class="n">cfg</span><span class="p">[</span><span class="s2">&quot;cmds&quot;</span><span class="p">]</span></div></div>


<span class="k">if</span> <span class="s2">&quot;uuuloader&quot;</span> <span class="ow">in</span> <span class="n">tbot</span><span class="o">.</span><span class="n">flags</span><span class="p">:</span>
    <span class="n">BOARDCTRL</span> <span class="o">=</span> <span class="n">boardControlUUU</span>
<span class="k">elif</span> <span class="s2">&quot;dfuutilloader&quot;</span> <span class="ow">in</span> <span class="n">tbot</span><span class="o">.</span><span class="n">flags</span><span class="p">:</span>
    <span class="n">BOARDCTRL</span> <span class="o">=</span> <span class="n">boardControlDFUUTIL</span>
<span class="k">elif</span> <span class="s2">&quot;lauterbachloader&quot;</span> <span class="ow">in</span> <span class="n">tbot</span><span class="o">.</span><span class="n">flags</span><span class="p">:</span>
    <span class="n">BOARDCTRL</span> <span class="o">=</span> <span class="n">boardControlLauterbach</span>
<span class="k">elif</span> <span class="s2">&quot;seggerloader&quot;</span> <span class="ow">in</span> <span class="n">tbot</span><span class="o">.</span><span class="n">flags</span><span class="p">:</span>
    <span class="n">BOARDCTRL</span> <span class="o">=</span> <span class="n">boardControlSegger</span>
<span class="k">elif</span> <span class="s2">&quot;xmodemloader&quot;</span> <span class="ow">in</span> <span class="n">tbot</span><span class="o">.</span><span class="n">flags</span><span class="p">:</span>
    <span class="n">BOARDCTRL</span> <span class="o">=</span> <span class="n">boardControlXmodem</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">BOARDCTRL</span> <span class="o">=</span> <span class="n">BOARDCTL</span>

<span class="k">if</span> <span class="s2">&quot;ssh&quot;</span> <span class="ow">in</span> <span class="n">tbot</span><span class="o">.</span><span class="n">flags</span><span class="p">:</span>
    <span class="n">BOARDCON</span> <span class="o">=</span> <span class="n">boardSSHConnector</span>
<span class="k">elif</span> <span class="s2">&quot;picocom&quot;</span> <span class="ow">in</span> <span class="n">tbot</span><span class="o">.</span><span class="n">flags</span><span class="p">:</span>
    <span class="n">BOARDCON</span> <span class="o">=</span> <span class="n">boardPicocomConnector</span>
<span class="k">elif</span> <span class="s2">&quot;scriptcom&quot;</span> <span class="ow">in</span> <span class="n">tbot</span><span class="o">.</span><span class="n">flags</span><span class="p">:</span>
    <span class="n">BOARDCON</span> <span class="o">=</span> <span class="n">boardScriptConnector</span>
<span class="k">else</span><span class="p">:</span>
    <span class="c1"># try to autodetect setup (config from tbot.ini file)</span>
    <span class="k">if</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">kermit</span><span class="p">:</span>
        <span class="n">BOARDCON</span> <span class="o">=</span> <span class="n">boardKermitConnector</span>
    <span class="k">elif</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">picocom</span><span class="p">:</span>
        <span class="n">BOARDCON</span> <span class="o">=</span> <span class="n">boardPicocomConnector</span>
    <span class="k">elif</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">scriptcom</span><span class="p">:</span>
        <span class="n">BOARDCON</span> <span class="o">=</span> <span class="n">boardScriptConnector</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Please setup console connector&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="boardControlFull"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.boardControlFull">[docs]</a><span class="k">class</span> <span class="nc">boardControlFull</span><span class="p">(</span><span class="n">BOARDCON</span><span class="p">,</span> <span class="n">BOARDCTRL</span><span class="p">,</span> <span class="n">board</span><span class="o">.</span><span class="n">Board</span><span class="p">):</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="boardExtPower"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.boardExtPower">[docs]</a><span class="k">class</span> <span class="nc">boardExtPower</span><span class="p">(</span><span class="n">BOARDCON</span><span class="p">,</span> <span class="n">board</span><span class="o">.</span><span class="n">Board</span><span class="p">):</span>
    <span class="k">pass</span></div>


<span class="k">if</span> <span class="s2">&quot;local&quot;</span> <span class="ow">in</span> <span class="n">tbot</span><span class="o">.</span><span class="n">flags</span><span class="p">:</span>
    <span class="n">CON</span> <span class="o">=</span> <span class="n">connector</span><span class="o">.</span><span class="n">SubprocessConnector</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">CON</span> <span class="o">=</span> <span class="n">connector</span><span class="o">.</span><span class="n">SSHConnector</span>

<span class="n">BH</span> <span class="o">=</span> <span class="n">typing</span><span class="o">.</span><span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;BH&quot;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="n">linux</span><span class="o">.</span><span class="n">Builder</span><span class="p">)</span>


<div class="viewcode-block" id="GenericLab"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.GenericLab">[docs]</a><span class="k">class</span> <span class="nc">GenericLab</span><span class="p">(</span><span class="n">CON</span><span class="p">,</span> <span class="n">LAB_LINUX_SHELL</span><span class="p">,</span> <span class="n">linux</span><span class="o">.</span><span class="n">Lab</span><span class="p">,</span> <span class="n">linux</span><span class="o">.</span><span class="n">Builder</span><span class="p">):</span>
    <span class="n">sectionname</span> <span class="o">=</span> <span class="n">LABSECTIONNAME</span>
    <span class="n">tmpdir_exists</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">nfsbasedir</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">nfsboardbasedir</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">LABSECTIONNAME</span><span class="p">,</span> <span class="s2">&quot;labname&quot;</span><span class="p">)</span>
    <span class="n">hostname</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">LABSECTIONNAME</span><span class="p">,</span> <span class="s2">&quot;hostname&quot;</span><span class="p">)</span>
    <span class="n">username</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">LABSECTIONNAME</span><span class="p">,</span> <span class="s2">&quot;username&quot;</span><span class="p">)</span>
    <span class="n">tftproot</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">LABSECTIONNAME</span><span class="p">,</span> <span class="s2">&quot;tftproot&quot;</span><span class="p">)</span>
    <span class="n">port</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">LABSECTIONNAME</span><span class="p">,</span> <span class="s2">&quot;port&quot;</span><span class="p">,</span> <span class="n">fallback</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
    <span class="n">nfs_base_path</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">LABSECTIONNAME</span><span class="p">,</span> <span class="s2">&quot;nfs_base_path&quot;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">enablelocking</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">LABSECTIONNAME</span><span class="p">,</span> <span class="s2">&quot;uselocking&quot;</span><span class="p">)</span>
        <span class="n">enablelocking</span> <span class="o">=</span> <span class="n">enablelocking</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">enablelocking</span> <span class="o">=</span> <span class="s2">&quot;no&quot;</span>

    <span class="n">bootmodecfg</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">bootmodecfg</span>
    <span class="n">ubcfg</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">ubcfg</span>
    <span class="n">ethdevices</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">ethdevices</span>
    <span class="n">uuucfg</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">uuucfg</span>
    <span class="n">lauterbachcfg</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">lauterbachcfg</span>
    <span class="n">seggercfg</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">seggercfg</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ssh_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        if ProxyJump does not work, execute this command from hand</span>
<span class="sd">        on the lab PC with BatchMode=no&quot; -&gt; answer allwith &quot;yes&quot;</span>
<span class="sd">        If again password question pops up, copy id_rsa.pub from</span>
<span class="sd">        lab PC to authorized_keys on build PC</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="s2">&quot;outside&quot;</span> <span class="ow">in</span> <span class="n">tbot</span><span class="o">.</span><span class="n">flags</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">tmp</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">LABSECTIONNAME</span><span class="p">,</span> <span class="s2">&quot;proxyjump&quot;</span><span class="p">)</span>
                <span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ProxyJump=</span><span class="si">{</span><span class="n">tmp</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>  <span class="c1"># noqa: E722</span>
                <span class="k">pass</span>

        <span class="k">return</span> <span class="n">args</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">authenticator</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">linux</span><span class="o">.</span><span class="n">auth</span><span class="o">.</span><span class="n">Authenticator</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">LABSECTIONNAME</span><span class="p">,</span> <span class="s2">&quot;sshkeyfile&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">linux</span><span class="o">.</span><span class="n">auth</span><span class="o">.</span><span class="n">PrivateKeyAuthenticator</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">password</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">LABSECTIONNAME</span><span class="p">,</span> <span class="s2">&quot;password&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">linux</span><span class="o">.</span><span class="n">auth</span><span class="o">.</span><span class="n">PasswordAuthenticator</span><span class="p">(</span><span class="n">password</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;you need to setup Authenticator for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">. Set &#39;sshkeyfile&#39; or &#39;password&#39; in section [</span><span class="si">{</span><span class="n">LABSECTIONNAME</span><span class="si">}</span><span class="s2">] in tbot.ini&quot;</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">tftp_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;linux.path.Path[GenericLab]&quot;</span><span class="p">:</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">linux</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tftp_root_path</span><span class="p">()</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">tftp_dir_board</span><span class="p">())</span>
        <span class="c1"># check if path exists, if not create it</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exec0</span><span class="p">(</span><span class="s2">&quot;mkdir&quot;</span><span class="p">,</span> <span class="s2">&quot;-p&quot;</span><span class="p">,</span> <span class="n">tmp</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tmp</span>

<div class="viewcode-block" id="GenericLab.tftp_root_path"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.GenericLab.tftp_root_path">[docs]</a>    <span class="k">def</span> <span class="nf">tftp_root_path</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;linux.Path[GenericLab]&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        returns root tftp path</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">linux</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tftproot</span><span class="p">)</span></div>

<div class="viewcode-block" id="GenericLab.tftp_dir_board"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.GenericLab.tftp_dir_board">[docs]</a>    <span class="k">def</span> <span class="nf">tftp_dir_board</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;linux.Path[GenericLab]&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        returns tftp path for u-boot tftp command</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">LABSECTIONNAME</span><span class="p">,</span> <span class="s2">&quot;tftpsubdir&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">linux</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tmp</span><span class="p">)</span></div>

<div class="viewcode-block" id="GenericLab.workdir"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.GenericLab.workdir">[docs]</a>    <span class="k">def</span> <span class="nf">workdir</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;linux.path.Path[GenericLab]&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        returns tbot workdir for this lab</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">LABSECTIONNAME</span><span class="p">,</span> <span class="s2">&quot;workdir&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">linux</span><span class="o">.</span><span class="n">Workdir</span><span class="o">.</span><span class="n">static</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tmp</span><span class="p">)</span></div>

<div class="viewcode-block" id="GenericLab.tmpdir"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.GenericLab.tmpdir">[docs]</a>    <span class="k">def</span> <span class="nf">tmpdir</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;linux.path.Path[GenericLab]&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        returns tbot tmpdir for this lab</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">LABSECTIONNAME</span><span class="p">,</span> <span class="s2">&quot;tmpdir&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tmpdir_exists</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">ret</span><span class="p">,</span> <span class="n">log</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="s2">&quot;ls&quot;</span><span class="p">,</span> <span class="n">tmp</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ret</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">exec0</span><span class="p">(</span><span class="s2">&quot;mkdir&quot;</span><span class="p">,</span> <span class="s2">&quot;-p&quot;</span><span class="p">,</span> <span class="n">tmp</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tmpdir_exists</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="n">linux</span><span class="o">.</span><span class="n">Workdir</span><span class="o">.</span><span class="n">static</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tmp</span><span class="p">)</span></div>

<div class="viewcode-block" id="GenericLab.tmpmntdir"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.GenericLab.tmpmntdir">[docs]</a>    <span class="k">def</span> <span class="nf">tmpmntdir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;linux.path.Path[GenericLab]&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        returns tbot tmpdir for mounting stuff on this lab</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tmpdir</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">linux</span><span class="o">.</span><span class="n">Workdir</span><span class="o">.</span><span class="n">static</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tmp</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;mnt</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="GenericLab.nfsbasedir"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.GenericLab.nfsbasedir">[docs]</a>    <span class="k">def</span> <span class="nf">nfsbasedir</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;linux.path.Path[GenericLab]&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        returns nfs base directory, configured in section [LABHOST]</span>
<span class="sd">        in ```tbot.ini```, key value ```nfs_base_path```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">linux</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nfs_base_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nfsbasedir</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">ret</span><span class="p">,</span> <span class="n">log</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="s2">&quot;ls&quot;</span><span class="p">,</span> <span class="n">tmp</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ret</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">exec0</span><span class="p">(</span><span class="s2">&quot;mkdir&quot;</span><span class="p">,</span> <span class="s2">&quot;-p&quot;</span><span class="p">,</span> <span class="n">tmp</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nfsbasedir_exists</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="n">linux</span><span class="o">.</span><span class="n">Workdir</span><span class="o">.</span><span class="n">static</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tmp</span><span class="p">)</span></div>

<div class="viewcode-block" id="GenericLab.nfsboardbasedir"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.GenericLab.nfsboardbasedir">[docs]</a>    <span class="k">def</span> <span class="nf">nfsboardbasedir</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;linux.path.Path[GenericLab]&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        returns nfs base directory for the specific board,</span>
<span class="sd">        configured in section [default] in ```BOARDNAME.ini```,</span>
<span class="sd">        key value ```nfs_path```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># we need board config here, but we cannot import</span>
        <span class="c1"># this global</span>
        <span class="kn">from</span> <span class="nn">tbottest.boardgeneric</span> <span class="kn">import</span> <span class="n">cfggeneric</span>

        <span class="n">cfg</span> <span class="o">=</span> <span class="n">cfggeneric</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">cfgp</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="s2">&quot;nfs_path&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nfsboardbasedir</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">ret</span><span class="p">,</span> <span class="n">log</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="s2">&quot;ls&quot;</span><span class="p">,</span> <span class="n">tmp</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ret</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">exec0</span><span class="p">(</span><span class="s2">&quot;mkdir&quot;</span><span class="p">,</span> <span class="s2">&quot;-p&quot;</span><span class="p">,</span> <span class="n">tmp</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nfsboardbasedir</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="n">linux</span><span class="o">.</span><span class="n">Workdir</span><span class="o">.</span><span class="n">static</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tmp</span><span class="p">)</span></div>

<div class="viewcode-block" id="GenericLab.toolsdir"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.GenericLab.toolsdir">[docs]</a>    <span class="k">def</span> <span class="nf">toolsdir</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;linux.path.Path[GenericLab]&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        returns directory where tbot finds tools</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">LABSECTIONNAME</span><span class="p">,</span> <span class="s2">&quot;toolsdir&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">linux</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tmp</span><span class="p">)</span></div>

<div class="viewcode-block" id="GenericLab.yocto_result_dir"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.GenericLab.yocto_result_dir">[docs]</a>    <span class="k">def</span> <span class="nf">yocto_result_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;linux.Path[GenericLab]&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        returns path to directory where tbot finds yocto build results</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tftp_dir</span><span class="p">()</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">toolchains</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">linux</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">Toolchain</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;bootlin-armv5-eabi&quot;</span><span class="p">:</span> <span class="n">linux</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">EnvSetBootlinToolchain</span><span class="p">(</span>
                <span class="n">arch</span><span class="o">=</span><span class="s2">&quot;armv5-eabi&quot;</span><span class="p">,</span>
                <span class="n">libc</span><span class="o">=</span><span class="s2">&quot;glibc&quot;</span><span class="p">,</span>
                <span class="n">typ</span><span class="o">=</span><span class="s2">&quot;stable&quot;</span><span class="p">,</span>
                <span class="n">date</span><span class="o">=</span><span class="s2">&quot;2018.11-1&quot;</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="s2">&quot;linaro-gnueabi&quot;</span><span class="p">:</span> <span class="n">linux</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">EnvSetLinaroToolchain</span><span class="p">(</span>
                <span class="n">host_arch</span><span class="o">=</span><span class="s2">&quot;x86_64&quot;</span><span class="p">,</span>
                <span class="n">arch</span><span class="o">=</span><span class="s2">&quot;arm-linux-gnueabi&quot;</span><span class="p">,</span>
                <span class="n">date</span><span class="o">=</span><span class="s2">&quot;2019.12&quot;</span><span class="p">,</span>
                <span class="n">gcc_vers</span><span class="o">=</span><span class="s2">&quot;7.5&quot;</span><span class="p">,</span>
                <span class="n">gcc_subvers</span><span class="o">=</span><span class="s2">&quot;0&quot;</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">}</span>

<div class="viewcode-block" id="GenericLab.lab_set_sd_mux_mode"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.GenericLab.lab_set_sd_mux_mode">[docs]</a>    <span class="k">def</span> <span class="nf">lab_set_sd_mux_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set sd mux mode to lab or dut</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;lab&quot;</span><span class="p">:</span>
            <span class="n">md</span> <span class="o">=</span> <span class="s2">&quot;--ts&quot;</span>
        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;dut&quot;</span><span class="p">:</span>
            <span class="n">md</span> <span class="o">=</span> <span class="s2">&quot;--dut&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;only mode &#39;dut&#39; or &#39;lab&#39; allowed for mode not </span><span class="si">{mode}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">sdwireserial</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;SDWIRE&quot;</span><span class="p">,</span> <span class="s2">&quot;serial&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">exec0</span><span class="p">(</span>
                <span class="s2">&quot;sudo&quot;</span><span class="p">,</span>
                <span class="s2">&quot;/usr/local/bin/sd-mux-ctrl&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;--device-serial=</span><span class="si">{</span><span class="n">sdwireserial</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">md</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>  <span class="c1"># noqa: E722</span>
            <span class="n">tbot</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">message</span><span class="p">(</span><span class="n">tbot</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="s2">&quot;no sd wire on this labhost&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">yellow</span><span class="p">)</span>
            <span class="k">pass</span></div>

<div class="viewcode-block" id="GenericLab.set_bootmode"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.GenericLab.set_bootmode">[docs]</a>    <span class="k">def</span> <span class="nf">set_bootmode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wantbootmode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set the bootmode defined in config file section [BOOTMODE_&lt;boardname&gt;]</span>

<span class="sd">        example config for gpio setup:</span>

<span class="sd">        .. code-block:: ini</span>

<span class="sd">            [BOOTMODE_testboard]</span>
<span class="sd">            modes = [{&quot;name&quot;:&quot;bootmode:uart0&quot;, &quot;gpios&quot;:&quot;26:1 19:0&quot;}, {&quot;name&quot;:&quot;bootmode:spinor&quot;, &quot;gpios&quot;:&quot;26:0 19:0&quot;} ]</span>

<span class="sd">        .. code-block:: bash</span>

<span class="sd">            -f bootmode:uart0</span>
<span class="sd">            -f bootmode:spinor</span>

<span class="sd">        example config for sd mux:</span>

<span class="sd">        .. code-block:: ini</span>

<span class="sd">            [BOOTMODE_testboard]</span>
<span class="sd">            modes = [{&quot;name&quot;:&quot;bootmode:sd&quot;, &quot;sdwire&quot;:&quot;dut&quot;}, {&quot;name&quot;:&quot;bootmode:emmc&quot;, &quot;sdwire&quot;:&quot;lab&quot;} ]</span>

<span class="sd">        .. code-block:: bash</span>

<span class="sd">            -f bootmode:sd</span>
<span class="sd">            -f bootmode:emmc</span>

<span class="sd">        example config for calling function in tbotconfig/labcallbacks.py:</span>

<span class="sd">        .. code-block:: ini</span>

<span class="sd">            [BOOTMODE_testboard]</span>
<span class="sd">            modes = [{&quot;name&quot;:&quot;bootmode:usb&quot;, &quot;func&quot;:&quot;board_setbootmode_usb&quot;}, {&quot;name&quot;:&quot;bootmode:emmc&quot;, &quot;func&quot;:&quot;board_setbootmode_emmc&quot;} ]</span>

<span class="sd">        .. code-block:: bash</span>

<span class="sd">            -f bootmode:usb</span>
<span class="sd">            -f bootmode:emmc</span>

<span class="sd">        .. warning::</span>

<span class="sd">            This is a hack !</span>

<span class="sd">            You need to add the new file tbotconfig/labcallbacks.py and</span>
<span class="sd">            implement there the files you define in &quot;modes&quot;</span>

<span class="sd">            Only use it, for fast testing, then implement it in a class!</span>

<span class="sd">        Currently there is only one argument passed:</span>

<span class="sd">        Example code</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            def board_setbootmode_usb(</span>
<span class="sd">                lab: linux.LinuxShell = None,</span>
<span class="sd">            ) -&gt; None:  # noqa: D107</span>
<span class="sd">                # call commands on lab with</span>
<span class="sd">                # lab.exec0(&quot;....&quot;)</span>
<span class="sd">                return True</span>

<span class="sd">        :param wantbootmode: str, bootmode string, use this, when you call the function from within python function</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">bootmodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bootmodecfg</span><span class="p">[</span><span class="n">ini</span><span class="o">.</span><span class="n">generic_get_boardname</span><span class="p">()]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="n">bms</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">bmtype</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">wantbootmode</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">bm</span> <span class="ow">in</span> <span class="n">bootmodes</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">bm</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">wantbootmode</span><span class="p">:</span>
                    <span class="n">bms</span> <span class="o">=</span> <span class="n">bm</span>
                    <span class="n">bmtype</span> <span class="o">=</span> <span class="s2">&quot;function&quot;</span>

        <span class="k">if</span> <span class="n">bms</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">bm</span> <span class="ow">in</span> <span class="n">bootmodes</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">bm</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">tbot</span><span class="o">.</span><span class="n">flags</span><span class="p">:</span>
                    <span class="n">bms</span> <span class="o">=</span> <span class="n">bm</span>
                    <span class="n">bmtype</span> <span class="o">=</span> <span class="s2">&quot;tbot.flag&quot;</span>

        <span class="k">if</span> <span class="n">bms</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tbot</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">message</span><span class="p">(</span>
                <span class="n">tbot</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;set bootmode </span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> from </span><span class="si">{</span><span class="n">bmtype</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">yellow</span>
            <span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">gpios</span> <span class="o">=</span> <span class="n">bms</span><span class="p">[</span><span class="s2">&quot;gpios&quot;</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">gpios</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">):</span>
                    <span class="n">gpionr</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">state</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">gpio</span> <span class="o">=</span> <span class="n">Gpio</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gpionr</span><span class="p">)</span>
                    <span class="n">gpio</span><span class="o">.</span><span class="n">set_direction</span><span class="p">(</span><span class="s2">&quot;out&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">state</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">gpio</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">gpio</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lab_set_sd_mux_mode</span><span class="p">(</span><span class="n">bms</span><span class="p">[</span><span class="s2">&quot;sdwire&quot;</span><span class="p">])</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">funcname</span> <span class="o">=</span> <span class="n">bms</span><span class="p">[</span><span class="s2">&quot;func&quot;</span><span class="p">]</span>
                <span class="n">func</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">get_boardcallback_import</span><span class="p">(),</span> <span class="n">funcname</span><span class="p">)</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">ret</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>

            <span class="n">tbot</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">message</span><span class="p">(</span><span class="n">tbot</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;set bootmode </span><span class="si">{</span><span class="n">bms</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> failed&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">red</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exit until callbacks work&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">False</span></div>

    <span class="k">def</span> <span class="nf">check_locking</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">enablelocking</span> <span class="o">==</span> <span class="s2">&quot;yes&quot;</span><span class="p">:</span>
            <span class="n">lab_get_lock</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

<div class="viewcode-block" id="GenericLab.init"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.GenericLab.init">[docs]</a>    <span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_locking</span><span class="p">()</span>

        <span class="c1"># check if nfs server is running, if not start it</span>
        <span class="c1"># utils.ensure_sd_unit(self, [&quot;nfs-server.service&quot;, &quot;tftp.socket&quot;])</span>
        <span class="c1"># check if we have eth0 connection, link and carrier</span>
        <span class="c1"># do not know, why pi always has no-carrier !!</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_bootmode</span><span class="p">()</span>

        <span class="k">if</span> <span class="s2">&quot;LABINIT&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_INIT_CACHE</span><span class="p">:</span>
            <span class="n">_INIT_CACHE</span><span class="p">[</span><span class="s2">&quot;LABINIT&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">labinitfilename</span> <span class="o">=</span> <span class="s2">&quot;/tmp/tbotlabinitdone&quot;</span>
            <span class="n">labinit</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">labinit</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">LABSECTIONNAME</span><span class="p">,</span> <span class="s2">&quot;labinit&quot;</span><span class="p">))</span>

                <span class="n">ret</span><span class="p">,</span> <span class="n">log</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exec</span><span class="p">(</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="s2">&quot;-f&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">labinitfilename</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ret</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">labinit</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">exec0</span><span class="p">(</span><span class="n">linux</span><span class="o">.</span><span class="n">Raw</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">exec0</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">linux</span><span class="o">.</span><span class="n">Raw</span><span class="p">(</span><span class="s2">&quot;&gt;&quot;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">labinitfilename</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>  <span class="c1"># noqa: E722</span>
                <span class="k">pass</span>

            <span class="k">if</span> <span class="s2">&quot;noethinit&quot;</span> <span class="ow">in</span> <span class="n">tbot</span><span class="o">.</span><span class="n">flags</span><span class="p">:</span>
                <span class="k">return</span>

            <span class="n">ethdevices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ethdevices</span><span class="p">[</span><span class="n">ini</span><span class="o">.</span><span class="n">generic_get_boardname</span><span class="p">()]</span>
            <span class="k">for</span> <span class="n">dev</span> <span class="ow">in</span> <span class="n">ethdevices</span><span class="p">:</span>
                <span class="n">ethdev</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ethdevices</span><span class="p">[</span><span class="n">ini</span><span class="o">.</span><span class="n">generic_get_boardname</span><span class="p">()][</span><span class="n">dev</span><span class="p">]</span>
                <span class="n">labdev</span> <span class="o">=</span> <span class="n">ethdev</span><span class="p">[</span><span class="s2">&quot;labdevice&quot;</span><span class="p">]</span>
                <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exec0</span><span class="p">(</span><span class="s2">&quot;ifconfig&quot;</span><span class="p">,</span> <span class="s2">&quot;-a&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">labdev</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">out</span><span class="p">:</span>
                    <span class="n">tbot</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">message</span><span class="p">(</span>
                        <span class="n">tbot</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">c</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;ethernet device </span><span class="si">{</span><span class="n">labdev</span><span class="si">}</span><span class="s2"> not found on lab host&quot;</span>
                        <span class="p">)</span><span class="o">.</span><span class="n">yellow</span>
                    <span class="p">)</span>
                    <span class="k">continue</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">exec0</span><span class="p">(</span><span class="s2">&quot;sudo&quot;</span><span class="p">,</span> <span class="s2">&quot;ifconfig&quot;</span><span class="p">,</span> <span class="n">labdev</span><span class="p">,</span> <span class="s2">&quot;down&quot;</span><span class="p">,</span> <span class="n">ethdev</span><span class="p">[</span><span class="s2">&quot;serverip&quot;</span><span class="p">],</span> <span class="s2">&quot;up&quot;</span><span class="p">)</span>
                <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exec0</span><span class="p">(</span><span class="s2">&quot;ip&quot;</span><span class="p">,</span> <span class="s2">&quot;link&quot;</span><span class="p">,</span> <span class="s2">&quot;show&quot;</span><span class="p">,</span> <span class="s2">&quot;dev&quot;</span><span class="p">,</span> <span class="n">labdev</span><span class="p">)</span>
                <span class="k">while</span> <span class="s2">&quot;NO-CARRIER&quot;</span> <span class="ow">in</span> <span class="n">out</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">exec0</span><span class="p">(</span><span class="s2">&quot;sudo&quot;</span><span class="p">,</span> <span class="s2">&quot;ethtool&quot;</span><span class="p">,</span> <span class="s2">&quot;-s&quot;</span><span class="p">,</span> <span class="n">labdev</span><span class="p">,</span> <span class="s2">&quot;autoneg&quot;</span><span class="p">,</span> <span class="s2">&quot;on&quot;</span><span class="p">)</span>
                    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exec0</span><span class="p">(</span><span class="s2">&quot;ip&quot;</span><span class="p">,</span> <span class="s2">&quot;link&quot;</span><span class="p">,</span> <span class="s2">&quot;show&quot;</span><span class="p">,</span> <span class="s2">&quot;dev&quot;</span><span class="p">,</span> <span class="n">labdev</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">has_sshmachine</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">sections</span><span class="p">():</span>
            <span class="k">if</span> <span class="s2">&quot;SSHMACHINE&quot;</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">sshmachine</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">linux</span><span class="o">.</span><span class="n">Bash</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_sshmachine</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">SSHMachine</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="SSHMachine"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.SSHMachine">[docs]</a><span class="k">class</span> <span class="nc">SSHMachine</span><span class="p">(</span><span class="n">connector</span><span class="o">.</span><span class="n">SSHConnector</span><span class="p">,</span> <span class="n">linux</span><span class="o">.</span><span class="n">Bash</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;SSHMACHINE&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span>
        <span class="n">username</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;SSHMACHINE&quot;</span><span class="p">,</span> <span class="s2">&quot;username&quot;</span><span class="p">)</span>
        <span class="n">port</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;SSHMACHINE&quot;</span><span class="p">,</span> <span class="s2">&quot;port&quot;</span><span class="p">)</span>
        <span class="n">hostname</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;SSHMACHINE&quot;</span><span class="p">,</span> <span class="s2">&quot;hostname&quot;</span><span class="p">)</span>
        <span class="n">wdir</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;SSHMACHINE&quot;</span><span class="p">,</span> <span class="s2">&quot;workdir&quot;</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">tftp_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;linux.path.Path[SSHMachine]&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">workdir</span>

    <span class="k">def</span> <span class="nf">toolsdir</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;linux.path.Path[SSHMachine]&quot;</span><span class="p">:</span>
        <span class="n">toolsdir</span> <span class="o">=</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;SSHMACHINE&quot;</span><span class="p">,</span> <span class="s2">&quot;toolsdir&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">linux</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">toolsdir</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">workdir</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;linux.Path[SSHMachine]&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">linux</span><span class="o">.</span><span class="n">Workdir</span><span class="o">.</span><span class="n">static</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wdir</span><span class="p">)</span>

<div class="viewcode-block" id="SSHMachine.init"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.SSHMachine.init">[docs]</a>    <span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># do stuff after login</span>
        <span class="c1"># self.exec0(&quot;uname&quot;, &quot;-a&quot;)</span>
        <span class="k">return</span> <span class="kc">None</span></div></div>


<div class="viewcode-block" id="LocalHostTest"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.LocalHostTest">[docs]</a><span class="k">class</span> <span class="nc">LocalHostTest</span><span class="p">(</span>
    <span class="n">connector</span><span class="o">.</span><span class="n">SubprocessConnector</span><span class="p">,</span> <span class="n">linux</span><span class="o">.</span><span class="n">Bash</span><span class="p">,</span> <span class="n">linux</span><span class="o">.</span><span class="n">Lab</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">ContextManager</span>
<span class="p">):</span>
    <span class="n">workdir_exists</span> <span class="o">=</span> <span class="kc">False</span>

<div class="viewcode-block" id="LocalHostTest.workdir"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.LocalHostTest.workdir">[docs]</a>    <span class="k">def</span> <span class="nf">workdir</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;linux.path.Path[LocalHostTest]&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        returns tbot workdir on Local Host</span>

<span class="sd">        default is ```/tmp```</span>

<span class="sd">        If you want to set it to other path set Environment</span>
<span class="sd">        variable ```TBOTTESTWORKPATH```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;TBOTTESTWORKPATH&quot;</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="s2">&quot;/tmp&quot;</span>

        <span class="n">tmp</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tmp</span><span class="si">}</span><span class="s2">/tbot&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">workdir_exists</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">exec0</span><span class="p">(</span><span class="s2">&quot;mkdir&quot;</span><span class="p">,</span> <span class="s2">&quot;-p&quot;</span><span class="p">,</span> <span class="n">tmp</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">workdir_exists</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="n">linux</span><span class="o">.</span><span class="n">Workdir</span><span class="o">.</span><span class="n">static</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tmp</span><span class="p">)</span></div>

<div class="viewcode-block" id="LocalHostTest.sourcedir"><a class="viewcode-back" href="../../labgeneric.html#tbottest.labgeneric.LocalHostTest.sourcedir">[docs]</a>    <span class="k">def</span> <span class="nf">sourcedir</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;linux.path.Path[LocalHostTest]&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        returns tbottest sourcedir on Local host</span>
<span class="sd">        (installation path of tbottest)</span>

<span class="sd">        default is ```.```</span>

<span class="sd">        If you need, you can set the path to tbottest</span>
<span class="sd">        through Environment variable ```TBOTTESTPATH```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;TBOTTESTPATH&quot;</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span>

        <span class="k">return</span> <span class="n">linux</span><span class="o">.</span><span class="n">Workdir</span><span class="o">.</span><span class="n">static</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tmp</span><span class="p">)</span></div></div>


<span class="k">def</span> <span class="nf">register_machines</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
    <span class="n">ctx</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">GenericLab</span><span class="p">,</span> <span class="n">tbot</span><span class="o">.</span><span class="n">role</span><span class="o">.</span><span class="n">LabHost</span><span class="p">)</span>
    <span class="n">ctx</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">LocalHostTest</span><span class="p">,</span> <span class="n">tbot</span><span class="o">.</span><span class="n">role</span><span class="o">.</span><span class="n">LocalHost</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">cfgt</span><span class="o">.</span><span class="n">config_parser</span><span class="o">.</span><span class="n">sections</span><span class="p">():</span>
        <span class="n">localfound</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="s2">&quot;BUILDHOST&quot;</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">tbot</span><span class="o">.</span><span class="n">flags</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;buildername:local&quot;</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
                    <span class="c1"># build on machine, on which tbot is startet!</span>
                    <span class="n">ctx</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">builders</span><span class="o">.</span><span class="n">genericbuilderlocal</span><span class="p">,</span> <span class="n">tbot</span><span class="o">.</span><span class="n">role</span><span class="o">.</span><span class="n">BuildHost</span><span class="p">)</span>
                    <span class="n">localfound</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">localfound</span><span class="p">:</span>
                <span class="n">ctx</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">builders</span><span class="o">.</span><span class="n">genericbuilder</span><span class="p">,</span> <span class="n">tbot</span><span class="o">.</span><span class="n">role</span><span class="o">.</span><span class="n">BuildHost</span><span class="p">)</span>

            <span class="k">return</span>


<span class="n">FLAGS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;local&quot;</span><span class="p">:</span> <span class="s2">&quot;enable if labhost and tbot host are the same (use SubprocessConnector)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;yoctobuild&quot;</span><span class="p">:</span> <span class="s2">&quot;use u-boot images from yocto build&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ssh&quot;</span><span class="p">:</span> <span class="s2">&quot;use as boards console login with ssh&quot;</span><span class="p">,</span>
    <span class="s2">&quot;withscript&quot;</span><span class="p">:</span> <span class="s2">&quot;also load a script with uuu tool into ram&quot;</span><span class="p">,</span>
    <span class="s2">&quot;uuuloader&quot;</span><span class="p">:</span> <span class="s2">&quot;load SPL/U-Boot with uuu tool into RAM&quot;</span><span class="p">,</span>
    <span class="s2">&quot;picocom&quot;</span><span class="p">:</span> <span class="s2">&quot;use piccom for accessing serial console&quot;</span><span class="p">,</span>
    <span class="s2">&quot;scriptcom&quot;</span><span class="p">:</span> <span class="s2">&quot;use a script for accessing serial console&quot;</span><span class="p">,</span>
    <span class="s2">&quot;tinkerforge&quot;</span><span class="p">:</span> <span class="s2">&quot;use tinkerforge for switching power&quot;</span><span class="p">,</span>
    <span class="s2">&quot;gpiopower&quot;</span><span class="p">:</span> <span class="s2">&quot;use gpio pin for switching power&quot;</span><span class="p">,</span>
    <span class="s2">&quot;powershellscript&quot;</span><span class="p">:</span> <span class="s2">&quot;use a shell script for switching power&quot;</span><span class="p">,</span>
    <span class="s2">&quot;poweroffonstart&quot;</span><span class="p">:</span> <span class="s2">&quot;always power off board on tbot start&quot;</span><span class="p">,</span>
    <span class="s2">&quot;labname&quot;</span><span class="p">:</span> <span class="s2">&quot;select which labhost we use&quot;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Heiko Schocher.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>